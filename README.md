# ASR Differ - –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –æ—Ü–µ–Ω–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è —Ä–µ—á–∏

–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è —ç—Ç–∞–ª–æ–Ω–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è —Ä–µ—á–∏ (ASR) —Å —Ä–∞—Å—á–µ—Ç–æ–º –º–µ—Ç—Ä–∏–∫ WER, CER –∏ –¥–µ—Ç–∞–ª—å–Ω—ã–º –∞–Ω–∞–ª–∏–∑–æ–º –æ—à–∏–±–æ–∫.

**–î–æ—Å—Ç—É–ø–Ω–æ:**
- üêç Python CLI —Å–∫—Ä–∏–ø—Ç
- üöÄ FastAPI REST API —Å–µ—Ä–≤–µ—Ä

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
# –û—Å–Ω–æ–≤–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
uv sync

# –° dev –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏ (–¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)
uv sync --all-extras
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### 1. CLI –≤–µ—Ä—Å–∏—è (Python —Å–∫—Ä–∏–ø—Ç)

#### –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```bash
python main.py
```

### 1. FastAPI REST API —Å–µ—Ä–≤–µ—Ä

#### –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞

```bash
# –ó–∞–ø—É—Å–∫ —Å uvicorn
uvicorn app:app --reload --host 0.0.0.0 --port 8000

# –ò–ª–∏ —á–µ—Ä–µ–∑ Python
python app.py
```

–°–µ—Ä–≤–µ—Ä –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ `http://localhost:8000`

#### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞:
- **Swagger UI**: http://localhost:8000/docs
- **ReDoc**: http://localhost:8000/redoc

#### Endpoints

##### `GET /`
–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ API

##### `GET /health`
–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–∏—Å–∞

##### `POST /compare`
–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —ç—Ç–∞–ª–æ–Ω–Ω–æ–≥–æ –∏ ASR —Ç–µ–∫—Å—Ç–æ–≤

**Request body:**
```json
{
  "reference_text": "–≤—Å–µ–º –¥–æ–±—Ä—ã–π –¥–µ–Ω—å —É –Ω–∞—Å 2024 –≥–æ–¥",
  "hypothesis_text": "–í—Å–µ–º –¥–æ–±—Ä—ã–π –¥–µ–Ω—å. –£ –Ω–∞—Å –¥–≤–µ —Ç—ã—Å—è—á–∏ –¥–≤–∞–¥—Ü–∞—Ç—å —á–µ—Ç–≤—ë—Ä—Ç—ã–π –≥–æ–¥."
}
```

**Response:**
```json
{
  "wer": 0.0,
  "cer": 0.0,
  "total_errors": 0,
  "substitutions": 0,
  "deletions": 0,
  "insertions": 0,
  "total_words": 7,
  "reference_normalized": "–≤—Å–µ–º –¥–æ–±—Ä—ã–π –¥–µ–Ω—å —É –Ω–∞—Å –¥–≤–µ —Ç—ã—Å—è—á–∏ –¥–≤–∞–¥—Ü–∞—Ç—å —á–µ—Ç—ã—Ä–µ –≥–æ–¥",
  "hypothesis_normalized": "–≤—Å–µ–º –¥–æ–±—Ä—ã–π –¥–µ–Ω—å —É –Ω–∞—Å –¥–≤–µ —Ç—ã—Å—è—á–∏ –¥–≤–∞–¥—Ü–∞—Ç—å —á–µ—Ç—ã—Ä–µ –≥–æ–¥"
}
```

#### –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å curl

```bash
curl -X POST "http://localhost:8000/compare" \
  -H "Content-Type: application/json" \
  -d '{
    "reference_text": "–≤—Å–µ–º –¥–æ–±—Ä—ã–π –¥–µ–Ω—å —É –Ω–∞—Å 2024 –≥–æ–¥",
    "hypothesis_text": "–í—Å–µ–º –¥–æ–±—Ä—ã–π –¥–µ–Ω—å. –£ –Ω–∞—Å –¥–≤–µ —Ç—ã—Å—è—á–∏ –¥–≤–∞–¥—Ü–∞—Ç—å —á–µ—Ç–≤—ë—Ä—Ç—ã–π –≥–æ–¥."
  }'
```

#### –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å Python

```python
import requests

response = requests.post(
    "http://localhost:8000/compare",
    json={
        "reference_text": "–≤—Å–µ–º –¥–æ–±—Ä—ã–π –¥–µ–Ω—å —É –Ω–∞—Å 2024 –≥–æ–¥",
        "hypothesis_text": "–í—Å–µ–º –¥–æ–±—Ä—ã–π –¥–µ–Ω—å. –£ –Ω–∞—Å –¥–≤–µ —Ç—ã—Å—è—á–∏ –¥–≤–∞–¥—Ü–∞—Ç—å —á–µ—Ç–≤—ë—Ä—Ç—ã–π –≥–æ–¥."
    }
)

result = response.json()
print(f"WER: {result['wer']:.2%}")
print(f"CER: {result['cer']:.2%}")
```

### 3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

#### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ —Å pytest

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ dev –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –µ—Å–ª–∏ –µ—â–µ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–∏–ª–∏
uv sync --all-extras

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç—ã
pytest test_app.py -v
```

#### –ó–∞–ø—É—Å–∫ –ª–æ–∫–∞–ª—å–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤

```bash
python test_app.py
```

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å—Ç–∏—Ç –Ω–∞–±–æ—Ä —Ç–µ—Å—Ç–æ–≤ –±–µ–∑ pytest –∏ –ø–æ–∫–∞–∂–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ –∫–æ–Ω—Å–æ–ª–∏.

## –ß—Ç–æ –¥–µ–ª–∞–µ—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç

1. **–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —á–∏—Å–µ–ª** (–ü–æ–∫–∞ —á—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç):
   - –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –≤—Å–µ —Ü–∏—Ñ—Ä—ã –≤ –µ–¥–∏–Ω—ã–π —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç
   - –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ç–µ–ª–µ—Ñ–æ–Ω–Ω—ã–µ –Ω–æ–º–µ—Ä–∞ ("8 800 200" ‚Üí "–≤–æ—Å–µ–º—å –≤–æ—Å–µ–º—å—Å–æ—Ç –¥–≤–µ—Å—Ç–∏")
   - –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –±–æ–ª—å—à–∏–µ —á–∏—Å–ª–∞ ("2200000" ‚Üí "–¥–≤–∞ –º–∏–ª–ª–∏–æ–Ω–∞ –¥–≤–µ—Å—Ç–∏ —Ç—ã—Å—è—á")

2. **–ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–∫—Å—Ç–∞**:
   - –ü—Ä–∏–≤–µ–¥–µ–Ω–∏–µ –∫ –Ω–∏–∂–Ω–µ–º—É —Ä–µ–≥–∏—Å—Ç—Ä—É
   - –ó–∞–º–µ–Ω–∞ "—ë" –Ω–∞ "–µ"
   - –£–¥–∞–ª–µ–Ω–∏–µ –ø—É–Ω–∫—Ç—É–∞—Ü–∏–∏
   - –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ–±–µ–ª–æ–≤

3. **–†–∞—Å—á–µ—Ç –º–µ—Ç—Ä–∏–∫**:
   - **WER** (Word Error Rate) - –ø—Ä–æ—Ü–µ–Ω—Ç –æ—à–∏–±–æ–∫ –Ω–∞ —É—Ä–æ–≤–Ω–µ —Å–ª–æ–≤
   - **CER** (Character Error Rate) - –ø—Ä–æ—Ü–µ–Ω—Ç –æ—à–∏–±–æ–∫ –Ω–∞ —É—Ä–æ–≤–Ω–µ —Å–∏–º–≤–æ–ª–æ–≤
   - –ü–æ–¥—Å—á–µ—Ç –∑–∞–º–µ–Ω (S), —É–¥–∞–ª–µ–Ω–∏–π (D) –∏ –≤—Å—Ç–∞–≤–æ–∫ (I)

4. **–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –æ—Ç–ª–∏—á–∏–π** (—Ç–æ–ª—å–∫–æ CLI):
   - –ü–æ—Å—Ç—Ä–æ—á–Ω—ã–π –≤—ã–≤–æ–¥ –≤—Å–µ—Ö —Ä–∞–∑–ª–∏—á–∏–π –º–µ–∂–¥—É —Ç–µ–∫—Å—Ç–∞–º–∏
   - –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–∏–ø—ã –æ—à–∏–±–æ–∫: –∑–∞–º–µ–Ω–∞, —É–¥–∞–ª–µ–Ω–∏–µ, –≤—Å—Ç–∞–≤–∫–∞

## –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞ (CLI)

```
--- üìä –ú–ï–¢–†–ò–ö–ò ---
Word Error Rate (WER): 3.45%
Character Error Rate (CER): 1.23%
--------------------
–í—Å–µ–≥–æ –æ—à–∏–±–æ–∫ (S+D+I –Ω–∞ —É—Ä–æ–≤–Ω–µ —Å–ª–æ–≤): 12
  - –ó–∞–º–µ–Ω—ã (S):     8
  - –£–¥–∞–ª–µ–Ω–∏—è (D):   2
  - –í—Å—Ç–∞–≤–∫–∏ (I):    2
–í—Å–µ–≥–æ —Å–ª–æ–≤ –≤ –æ—Ä–∏–≥–∏–Ω–∞–ª–µ: 347

--- üîç –°–ü–ò–°–û–ö –û–®–ò–ë–û–ö (–ø–æ —Å–ª–æ–≤–∞–º) ---
  [–ó–ê–ú–ï–ù–ê]  '–∞–ª–µ–∫—Å–∞–Ω–¥—Ä–∞' -> '–∞–ª–µ–∫—Å–∞–Ω–¥—Ä'
  [–£–î–ê–õ–ï–ù–û] '–∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏—è'
  [–í–°–¢–ê–í–õ–ï–ù–û] '–∞'
```
